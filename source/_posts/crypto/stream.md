---
title: 密码学概述和流密码
date: 2023-04-26 01:59:28
categories: crypto
---

## 引言

攻击分类：被动（监听、嗅探）；主动（中断、伪造、篡改）

安全类型：系统安全；数据安全；内容安全

密钥类型：

- 单钥：流密码；分组密码
- 双钥（公钥）

古典密码：

- 单表代换：加密 y = ax+b，解密 x = (y-b)/a

  凯撒密码；移位密码；仿射密码

- 多表代换：x = [x_1,x_2,...,x_n], a = [a_1,a_2,...,a_n], b = [b_1,b_2,...,b_n]

  多组密码加密解密为矩阵乘法，密文为一个向量 y = ax+b，相应明文线性运算即可

古典密码中 a,b 即为密钥，显然是单钥，加密和解密仅使用一套密钥

## 流密码

### 流密码的基本概念

##### 同步流密码、分组密码和一次一密密码

> 单钥密码：流密码和分组密码

流密码和分组密码的区别：转换函数是否由电子元件状态参与决定，即滚动密钥生成器生成密钥流时是否有自变量电子元件状态

- 但注意转换函数在单钥中都是固定的，且均是二元函数，自变量一为明文流，自变量二为密钥流，密钥流的产生不同区分流密码和分组密码

同步流密码和自同步流密码的区别：电子元件是否有记忆，电子元件状态是否被接收到的明文影响（同时电子元件状态将参与滚动密钥生成器的生成，进而影响密钥流和转换函数）

流密码和多表代换的区别：多表代换的转换函数是一元的，自变量为明文，其中密钥以常系数的形式参与转换，而流密码的转换函数为二元，自变量为密钥流和明文

- 值得注意的是，流密码的密钥流其实滚动密钥生成器根据元件状态 α 和密钥`k`得到的，密钥 k 本身是一个常量

流密码和一次一密密码的区别：滚动密钥生成器直接输出密钥 k 的当前值，密钥流少了一次变换，即一次一密密码中**密钥流等于密钥本身**，而流密码的密钥流由滚动密钥生成器动态生成

二元加法流密码，变换函数为明文和密钥流进行异或操作，当滚动密钥 z 等于密钥本身 k 时，二元加法流密码退化为一次一密密码

一个良好的密钥流 z 的性质：**极大的周期性，良好的统计特性，抗线性分析，抗统计分析**

##### 有限状态自动机和密钥流产生器

有限状态自动机五要素：输入，输出，状态，状态转移函数，输出函数

密钥流产生器：就是一个有限状态自动机，状态就是记忆电子元件的状态，输入为密钥`k`，输出为密钥流`z`，转移函数`1`为状态转移函数，规定元件状态经过当前输入到下一状态的转换，转移函数`2`为输出函数，输入和当前状态推出输出

从直觉上来说，非线性的密码将更难预测，但非线性的有限状态自动机很难实现，于是我们中和一下，将密匙流产生器分解，采用线性变化的有限状态自动机（驱动部分）控制生成器的状态转移，结合驱动部分的输出，通过非线性的子系统产生统计性能好的序列，作为最终的密钥流

<img src="/img/assets/producer.png">

### 线性反馈移位寄存器

先举一个非线性的反馈移位寄存器的栗子，这是一个生成函数
$$
f(a_1,a_2,a_3) = a_1a_2\oplus a_3
$$
我们会给定 a1,a2,a3 的初始值，假设为 (1,0,1)，则有
$$
a_4 = a_1a_2\oplus a_3 = 1\wedge0\oplus1 = 1\\
a_5 = a_2a_3\oplus a_4 = 0\wedge1\oplus1 = 1\\
......\\
a_{t+3} = a_ta_{t+1}\oplus a_{t+2}
$$
移位的概念，即指，每运算一次，方程 f 的入参向右整体移动一位，即上一轮为 f(a1,a2,a3)，则下一轮运算为 f(a2,a3,a4)，其中 a4 是上一轮的输出结果

这样不断输出，一定会得到一串重复的输出

<img src="/img/assets/FSR.png">

如上述输出的 1011 1011 1011...，并且，当
$$
a_t = a_{t+k}
$$
始终成立时，我们说 k 是该反馈移位寄存器的周期

上述的栗子中，f 并不是一个线性函数，所以我们说其是反馈移位寄存器，而不是线性反馈移位寄存器，当
$$
f = c_1a_1\oplus c_2a_2 \oplus...\oplus c_na_n\quad c_i = 1/0
$$
时，f 即为一个线性函数，其代表的反馈移位寄存器即为线性反馈移位寄存器，如下图线性移位寄存器，其 f = a4 ⊕ a1（c2 = c3 = c5 = 0）

<img src="/img/assets/LFSR.png">

假定初始序列为 (1,0,0,1,1)，则可以得到周期为 31 的重复序列

- 1001101001000010101110110001111100110......

教材原话：线性反馈移位寄存器输出序列的性质完全由其反馈函数决定。n级线性反馈移位寄存器最多有2^n个不同的状态。若其初始状态为0，则其状态恒为0。若其初始状态非0，则其后继状态不会为0。因此n级线性反馈移位寄存器的状态周期小于等于2^n-1。其输出序列的周期与状态周期相等,也小于等于2^n-1。只要选择合适的反馈函数便可使序列的周期达到最大值2^n-1，周期达到最大值的序列称为m序列

### 线性移位寄存器的一元多项式表示

